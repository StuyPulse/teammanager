<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class Rack::Cache::Response - rack-cache-1.2 Documentation</title>

<link type="text/css" media="screen" href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../index.html">Home</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/rack/cache/response.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">Object
  
</nav>

    <!-- Included Modules -->
<nav id="includes-section" class="section">
  <h3 class="section-header">Included Modules</h3>

  <ul class="link-list">
  
  
    <li><span class="include">Rack::Response::Helpers</span>
  
  
  </ul>
</nav>

    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-i-age">#age</a>
    
    <li><a href="#method-i-cache_control">#cache_control</a>
    
    <li><a href="#method-i-cache_control-3D">#cache_control=</a>
    
    <li><a href="#method-i-cacheable-3F">#cacheable?</a>
    
    <li><a href="#method-i-client_ttl-3D">#client_ttl=</a>
    
    <li><a href="#method-i-date">#date</a>
    
    <li><a href="#method-i-etag">#etag</a>
    
    <li><a href="#method-i-expire-21">#expire!</a>
    
    <li><a href="#method-i-expires">#expires</a>
    
    <li><a href="#method-i-fresh-3F">#fresh?</a>
    
    <li><a href="#method-i-initialize_copy">#initialize_copy</a>
    
    <li><a href="#method-i-last_modified">#last_modified</a>
    
    <li><a href="#method-i-max_age">#max_age</a>
    
    <li><a href="#method-i-max_age-3D">#max_age=</a>
    
    <li><a href="#method-i-must_revalidate-3F">#must_revalidate?</a>
    
    <li><a href="#method-i-not_modified-21">#not_modified!</a>
    
    <li><a href="#method-i-private-3D">#private=</a>
    
    <li><a href="#method-i-shared_max_age-3D">#shared_max_age=</a>
    
    <li><a href="#method-i-to_a">#to_a</a>
    
    <li><a href="#method-i-ttl">#ttl</a>
    
    <li><a href="#method-i-ttl-3D">#ttl=</a>
    
    <li><a href="#method-i-validateable-3F">#validateable?</a>
    
    <li><a href="#method-i-vary">#vary</a>
    
    <li><a href="#method-i-vary-3F">#vary?</a>
    
    <li><a href="#method-i-vary_header_names">#vary_header_names</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../../CHANGES.html">CHANGES</a>
  
    <li class="file"><a href="../../COPYING.html">COPYING</a>
  
    <li class="file"><a href="../../README.html">README</a>
  
    <li class="file"><a href="../../TODO.html">TODO</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../Rack.html">Rack</a>
  
    <li><a href="../../Rack/Cache.html">Rack::Cache</a>
  
    <li><a href="../../Rack/Cache/AppEngine.html">Rack::Cache::AppEngine</a>
  
    <li><a href="../../Rack/Cache/AppEngine/MC.html">Rack::Cache::AppEngine::MC</a>
  
    <li><a href="../../Rack/Cache/AppEngine/MemCache.html">Rack::Cache::AppEngine::MemCache</a>
  
    <li><a href="../../Rack/Cache/CacheControl.html">Rack::Cache::CacheControl</a>
  
    <li><a href="../../Rack/Cache/Context.html">Rack::Cache::Context</a>
  
    <li><a href="../../Rack/Cache/EntityStore.html">Rack::Cache::EntityStore</a>
  
    <li><a href="../../Rack/Cache/EntityStore/Disk.html">Rack::Cache::EntityStore::DISK</a>
  
    <li><a href="../../Rack/Cache/EntityStore/Dalli.html">Rack::Cache::EntityStore::Dalli</a>
  
    <li><a href="../../Rack/Cache/EntityStore/Disk.html">Rack::Cache::EntityStore::Disk</a>
  
    <li><a href="../../Rack/Cache/EntityStore/Disk.html">Rack::Cache::EntityStore::FILE</a>
  
    <li><a href="../../Rack/Cache/EntityStore/GAEStore.html">Rack::Cache::EntityStore::GAE</a>
  
    <li><a href="../../Rack/Cache/EntityStore/GAEStore.html">Rack::Cache::EntityStore::GAECACHE</a>
  
    <li><a href="../../Rack/Cache/EntityStore/GAEStore.html">Rack::Cache::EntityStore::GAEStore</a>
  
    <li><a href="../../Rack/Cache/EntityStore/Heap.html">Rack::Cache::EntityStore::HEAP</a>
  
    <li><a href="../../Rack/Cache/EntityStore/Heap.html">Rack::Cache::EntityStore::Heap</a>
  
    <li><a href="../../Rack/Cache/EntityStore/Heap.html">Rack::Cache::EntityStore::MEM</a>
  
    <li><a href="../../Rack/Cache/EntityStore/MemCacheBase.html">Rack::Cache::EntityStore::MemCacheBase</a>
  
    <li><a href="../../Rack/Cache/EntityStore/MemCached.html">Rack::Cache::EntityStore::MemCached</a>
  
    <li><a href="../../Rack/Cache/Key.html">Rack::Cache::Key</a>
  
    <li><a href="../../Rack/Cache/MetaStore.html">Rack::Cache::MetaStore</a>
  
    <li><a href="../../Rack/Cache/MetaStore/Disk.html">Rack::Cache::MetaStore::DISK</a>
  
    <li><a href="../../Rack/Cache/MetaStore/Dalli.html">Rack::Cache::MetaStore::Dalli</a>
  
    <li><a href="../../Rack/Cache/MetaStore/Disk.html">Rack::Cache::MetaStore::Disk</a>
  
    <li><a href="../../Rack/Cache/MetaStore/Disk.html">Rack::Cache::MetaStore::FILE</a>
  
    <li><a href="../../Rack/Cache/MetaStore/GAEStore.html">Rack::Cache::MetaStore::GAE</a>
  
    <li><a href="../../Rack/Cache/MetaStore/GAEStore.html">Rack::Cache::MetaStore::GAECACHE</a>
  
    <li><a href="../../Rack/Cache/MetaStore/GAEStore.html">Rack::Cache::MetaStore::GAEStore</a>
  
    <li><a href="../../Rack/Cache/MetaStore/Heap.html">Rack::Cache::MetaStore::HEAP</a>
  
    <li><a href="../../Rack/Cache/MetaStore/Heap.html">Rack::Cache::MetaStore::Heap</a>
  
    <li><a href="../../Rack/Cache/MetaStore/Heap.html">Rack::Cache::MetaStore::MEM</a>
  
    <li><a href="../../Rack/Cache/MetaStore/MemCacheBase.html">Rack::Cache::MetaStore::MemCacheBase</a>
  
    <li><a href="../../Rack/Cache/MetaStore/MemCached.html">Rack::Cache::MetaStore::MemCached</a>
  
    <li><a href="../../Rack/Cache/Options.html">Rack::Cache::Options</a>
  
    <li><a href="../../Rack/Cache/Request.html">Rack::Cache::Request</a>
  
    <li><a href="../../Rack/Cache/Response.html">Rack::Cache::Response</a>
  
    <li><a href="../../Rack/Cache/Storage.html">Rack::Cache::Storage</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class Rack::Cache::Response</h1>

  <div id="description" class="description">
    
<p>Provides access to the response generated by the downstream application.
The <code>response</code>, <code>original_response</code>, and
<code>entry</code> objects exposed by the Core caching engine are instances
of this class.</p>

<p><a href="Response.html">Response</a> objects respond to a variety of
convenience methods, including those defined in Rack::Response::Helpers,
Rack::Cache::Headers, and Rack::Cache::ResponseHeaders.</p>

<p>Note that <a href="Response.html">Rack::Cache::Response</a> is not a
subclass of Rack::Response and does not perform many of the same
initialization and finalization tasks. For example, the body is not slurped
during initialization and there are no facilities for generating response
output.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="CACHEABLE_RESPONSE_CODES">CACHEABLE_RESPONSE_CODES
        
        <dd class="description"><p>Status codes of responses that MAY be stored by a cache or used in reply to
a subsequent request.</p>

<p><a
href="http://tools.ietf.org/html/rfc2616#section-13.4">tools.ietf.org/html/rfc2616#section-13.4</a></p>
        
      
        <dt id="NOT_MODIFIED_OMIT_HEADERS">NOT_MODIFIED_OMIT_HEADERS
        
        <dd class="description"><p>Headers that MUST NOT be included with 304 Not Modified responses.</p>

<p><a
href="http://tools.ietf.org/html/rfc2616#section-10.3.5">tools.ietf.org/html/rfc2616#section-10.3.5</a></p>
        
      
      </dl>
    </section>
    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-i-body" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">body</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p><a href="../../Rack.html">Rack</a> response tuple accessors.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-headers" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">headers</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p><a href="../../Rack.html">Rack</a> response tuple accessors.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-now" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">now</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The time when the <a href="Response.html">Response</a> object was
instantiated.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-status" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">status</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p><a href="../../Rack.html">Rack</a> response tuple accessors.</p>
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(status, headers, body)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Create a <a href="Response.html">Response</a> instance given the response
status code, header hash, and body.</p>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 32</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">status</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">body</span>)
  <span class="ruby-ivar">@status</span> = <span class="ruby-identifier">status</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-ivar">@headers</span> = <span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span><span class="ruby-operator">::</span><span class="ruby-constant">HeaderHash</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">headers</span>)
  <span class="ruby-ivar">@body</span> = <span class="ruby-identifier">body</span>
  <span class="ruby-ivar">@now</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
  <span class="ruby-ivar">@headers</span>[<span class="ruby-string">'Date'</span>] <span class="ruby-operator">||=</span> <span class="ruby-ivar">@now</span>.<span class="ruby-identifier">httpdate</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-age" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">age</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The age of the response.</p>
          

          
          <div class="method-source-code" id="age-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 148</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">age</span>
  (<span class="ruby-identifier">headers</span>[<span class="ruby-string">'Age'</span>] <span class="ruby-operator">||</span>  [(<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">date</span>).<span class="ruby-identifier">to_i</span>, <span class="ruby-value">0</span>].<span class="ruby-identifier">max</span>).<span class="ruby-identifier">to_i</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- age-source -->
          
        </div>

        

        
      </div><!-- age-method -->

    
      <div id="method-i-cache_control" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cache_control</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>A Hash of name=value pairs that correspond to the Cache-Control header.
Valueless parameters (e.g., must-revalidate, no-store) have a Hash value of
true. This method always returns a Hash, empty if no Cache-Control header
is present.</p>
          

          
          <div class="method-source-code" id="cache_control-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 68</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cache_control</span>
  <span class="ruby-ivar">@cache_control</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">CacheControl</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">headers</span>[<span class="ruby-string">'Cache-Control'</span>])
<span class="ruby-keyword">end</span></pre>
          </div><!-- cache_control-source -->
          
        </div>

        

        
      </div><!-- cache_control-method -->

    
      <div id="method-i-cache_control-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cache_control=</span><span
            class="method-args">(value)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Set the Cache-Control header to the values specified by the Hash. See the
<a href="Response.html#method-i-cache_control">cache_control</a> method for
information on expected Hash structure.</p>
          

          
          <div class="method-source-code" id="cache_control-3D-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 74</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cache_control=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:to_hash</span>
    <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">clear</span>
    <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">value</span>)
    <span class="ruby-identifier">value</span> = <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">'Cache-Control'</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">headers</span>[<span class="ruby-string">'Cache-Control'</span>] = <span class="ruby-identifier">value</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- cache_control-3D-source -->
          
        </div>

        

        
      </div><!-- cache_control-3D-method -->

    
      <div id="method-i-cacheable-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cacheable?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Determine if the response is worth caching under any circumstance.
Responses marked “private” with an explicit Cache-Control directive are
considered uncacheable</p>

<p>Responses with neither a freshness lifetime (Expires, max-age) nor cache
validator (Last-Modified, ETag) are considered uncacheable.</p>
          

          
          <div class="method-source-code" id="cacheable-3F-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 102</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cacheable?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">CACHEABLE_RESPONSE_CODES</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">status</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">no_store?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">private?</span>
  <span class="ruby-identifier">validateable?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">fresh?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- cacheable-3F-source -->
          
        </div>

        

        
      </div><!-- cacheable-3F-method -->

    
      <div id="method-i-client_ttl-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">client_ttl=</span><span
            class="method-args">(seconds)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Set the response’s time-to-live for private/client caches. This adjusts the
Cache-Control/max-age directive.</p>
          

          
          <div class="method-source-code" id="client_ttl-3D-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 196</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">client_ttl=</span>(<span class="ruby-identifier">seconds</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">max_age</span> = <span class="ruby-identifier">age</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">seconds</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- client_ttl-3D-source -->
          
        </div>

        

        
      </div><!-- client_ttl-3D-method -->

    
      <div id="method-i-date" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">date</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The date, as specified by the Date header. When no Date header is present,
set the Date header to Time.now and return.</p>
          

          
          <div class="method-source-code" id="date-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 138</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">date</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">date</span> = <span class="ruby-identifier">headers</span>[<span class="ruby-string">'Date'</span>]
    <span class="ruby-constant">Time</span>.<span class="ruby-identifier">httpdate</span>(<span class="ruby-identifier">date</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">headers</span>[<span class="ruby-string">'Date'</span>] = <span class="ruby-identifier">now</span>.<span class="ruby-identifier">httpdate</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">frozen?</span>
    <span class="ruby-identifier">now</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- date-source -->
          
        </div>

        

        
      </div><!-- date-method -->

    
      <div id="method-i-etag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">etag</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The literal value of ETag HTTP header or nil if no ETag is specified.</p>
          

          
          <div class="method-source-code" id="etag-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 207</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">etag</span>
  <span class="ruby-identifier">headers</span>[<span class="ruby-string">'ETag'</span>]
<span class="ruby-keyword">end</span></pre>
          </div><!-- etag-source -->
          
        </div>

        

        
      </div><!-- etag-method -->

    
      <div id="method-i-expire-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">expire!</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Mark the response stale by setting the Age header to be equal to the
maximum age of the response.</p>
          

          
          <div class="method-source-code" id="expire-21-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 132</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">expire!</span>
  <span class="ruby-identifier">headers</span>[<span class="ruby-string">'Age'</span>] = <span class="ruby-identifier">max_age</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">fresh?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- expire-21-source -->
          
        </div>

        

        
      </div><!-- expire-21-method -->

    
      <div id="method-i-expires" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">expires</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The value of the Expires header as a Time object.</p>
          

          
          <div class="method-source-code" id="expires-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 164</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">expires</span>
  <span class="ruby-identifier">headers</span>[<span class="ruby-string">'Expires'</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">httpdate</span>(<span class="ruby-identifier">headers</span>[<span class="ruby-string">'Expires'</span>])
<span class="ruby-keyword">end</span></pre>
          </div><!-- expires-source -->
          
        </div>

        

        
      </div><!-- expires-method -->

    
      <div id="method-i-fresh-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fresh?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Determine if the response is “fresh”. Fresh responses may be served from
cache without any interaction with the origin. A response is considered
fresh when it includes a Cache-Control/max-age indicator or Expiration
header and the calculated age is less than the freshness lifetime.</p>
          

          
          <div class="method-source-code" id="fresh-3F-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 92</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fresh?</span>
  <span class="ruby-identifier">ttl</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">ttl</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- fresh-3F-source -->
          
        </div>

        

        
      </div><!-- fresh-3F-method -->

    
      <div id="method-i-initialize_copy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">initialize_copy</span><span
            class="method-args">(other)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="initialize_copy-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize_copy</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-keyword">super</span>
  <span class="ruby-ivar">@headers</span> = <span class="ruby-identifier">other</span>.<span class="ruby-identifier">headers</span>.<span class="ruby-identifier">dup</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- initialize_copy-source -->
          
        </div>

        

        
      </div><!-- initialize_copy-method -->

    
      <div id="method-i-last_modified" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">last_modified</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The String value of the Last-Modified header exactly as it appears in the
response (i.e., no date parsing / conversion is performed).</p>
          

          
          <div class="method-source-code" id="last_modified-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 202</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">last_modified</span>
  <span class="ruby-identifier">headers</span>[<span class="ruby-string">'Last-Modified'</span>]
<span class="ruby-keyword">end</span></pre>
          </div><!-- last_modified-source -->
          
        </div>

        

        
      </div><!-- last_modified-method -->

    
      <div id="method-i-max_age" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">max_age</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The number of seconds after the time specified in the response’s Date
header when the the response should no longer be considered fresh. First
check for a s-maxage directive, then a max-age directive, and then fall
back on an expires header; return nil when no maximum age can be
established.</p>
          

          
          <div class="method-source-code" id="max_age-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 157</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">max_age</span>
  <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">shared_max_age</span> <span class="ruby-operator">||</span>
    <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">max_age</span> <span class="ruby-operator">||</span>
    (<span class="ruby-identifier">expires</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">expires</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">date</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- max_age-source -->
          
        </div>

        

        
      </div><!-- max_age-method -->

    
      <div id="method-i-max_age-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">max_age=</span><span
            class="method-args">(value)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The number of seconds after which the response should no longer be
considered fresh. Sets the Cache-Control max-age directive.</p>
          

          
          <div class="method-source-code" id="max_age-3D-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 170</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">max_age=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cache_control</span> = <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-string">'max-age'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- max_age-3D-source -->
          
        </div>

        

        
      </div><!-- max_age-3D-method -->

    
      <div id="method-i-must_revalidate-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">must_revalidate?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Indicates that the cache must not serve a stale response in any
circumstance without first revalidating with the origin. When present, the
TTL of the response should not be overriden to be greater than the value
provided by the origin.</p>
          

          
          <div class="method-source-code" id="must_revalidate-3F-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 126</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">must_revalidate?</span>
  <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">must_revalidate</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">proxy_revalidate</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- must_revalidate-3F-source -->
          
        </div>

        

        
      </div><!-- must_revalidate-3F-method -->

    
      <div id="method-i-not_modified-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">not_modified!</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Modify the response so that it conforms to the rules defined for ‘304 Not
Modified’. This sets the status, removes the body, and discards any headers
that MUST NOT be included in 304 responses.</p>

<p><a
href="http://tools.ietf.org/html/rfc2616#section-10.3.5">tools.ietf.org/html/rfc2616#section-10.3.5</a></p>
          

          
          <div class="method-source-code" id="not_modified-21-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 229</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">not_modified!</span>
  <span class="ruby-identifier">body</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">body</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:close</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">304</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">body</span> = []
  <span class="ruby-constant">NOT_MODIFIED_OMIT_HEADERS</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">name</span>) }
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- not_modified-21-source -->
          
        </div>

        

        
      </div><!-- not_modified-21-method -->

    
      <div id="method-i-private-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">private=</span><span
            class="method-args">(value)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Mark the response “private”, making it ineligible for serving other
clients.</p>
          

          
          <div class="method-source-code" id="private-3D-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 116</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">private=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cache_control</span> = <span class="ruby-identifier">cache_control</span>.
    <span class="ruby-identifier">merge</span>(<span class="ruby-string">'public'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">value</span>, <span class="ruby-string">'private'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">value</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- private-3D-source -->
          
        </div>

        

        
      </div><!-- private-3D-method -->

    
      <div id="method-i-shared_max_age-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">shared_max_age=</span><span
            class="method-args">(value)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Like <a href="Response.html#method-i-max_age-3D">max_age=</a> but sets the
s-maxage directive, which applies only to shared caches.</p>
          

          
          <div class="method-source-code" id="shared_max_age-3D-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 176</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">shared_max_age=</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cache_control</span> = <span class="ruby-identifier">cache_control</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-string">'s-maxage'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- shared_max_age-3D-source -->
          
        </div>

        

        
      </div><!-- shared_max_age-3D-method -->

    
      <div id="method-i-to_a" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">to_a</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Return the status, headers, and body in a three-tuple.</p>
          

          
          <div class="method-source-code" id="to_a-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 46</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_a</span>
  [<span class="ruby-identifier">status</span>, <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">to_hash</span>, <span class="ruby-identifier">body</span>]
<span class="ruby-keyword">end</span></pre>
          </div><!-- to_a-source -->
          
        </div>

        

        
      </div><!-- to_a-method -->

    
      <div id="method-i-ttl" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ttl</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The response’s time-to-live in seconds, or nil when no freshness
information is present in the response. When the responses <a
href="Response.html#method-i-ttl">ttl</a> is &lt;= 0, the response may not
be served from cache without first revalidating with the origin.</p>
          

          
          <div class="method-source-code" id="ttl-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 184</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ttl</span>
  <span class="ruby-identifier">max_age</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">age</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">max_age</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ttl-source -->
          
        </div>

        

        
      </div><!-- ttl-method -->

    
      <div id="method-i-ttl-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ttl=</span><span
            class="method-args">(seconds)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Set the response’s time-to-live for shared caches to the specified number
of seconds. This adjusts the Cache-Control/s-maxage directive.</p>
          

          
          <div class="method-source-code" id="ttl-3D-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 190</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ttl=</span>(<span class="ruby-identifier">seconds</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">shared_max_age</span> = <span class="ruby-identifier">age</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">seconds</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ttl-3D-source -->
          
        </div>

        

        
      </div><!-- ttl-3D-method -->

    
      <div id="method-i-validateable-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validateable?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Determine if the response includes headers that can be used to validate the
response with the origin using a conditional GET request.</p>
          

          
          <div class="method-source-code" id="validateable-3F-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 110</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validateable?</span>
  <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">'Last-Modified'</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-string">'ETag'</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- validateable-3F-source -->
          
        </div>

        

        
      </div><!-- validateable-3F-method -->

    
      <div id="method-i-vary" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vary</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The literal value of the Vary header, or nil when no header is present.</p>
          

          
          <div class="method-source-code" id="vary-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 238</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vary</span>
  <span class="ruby-identifier">headers</span>[<span class="ruby-string">'Vary'</span>]
<span class="ruby-keyword">end</span></pre>
          </div><!-- vary-source -->
          
        </div>

        

        
      </div><!-- vary-method -->

    
      <div id="method-i-vary-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vary?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Does the response include a Vary header?</p>
          

          
          <div class="method-source-code" id="vary-3F-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 243</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vary?</span>
  <span class="ruby-operator">!</span> <span class="ruby-identifier">vary</span>.<span class="ruby-identifier">nil?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- vary-3F-source -->
          
        </div>

        

        
      </div><!-- vary-3F-method -->

    
      <div id="method-i-vary_header_names" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vary_header_names</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>An array of header names given in the Vary header or an empty array when no
Vary header is present.</p>
          

          
          <div class="method-source-code" id="vary_header_names-source">
            <pre><span class="ruby-comment"># File lib/rack/cache/response.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vary_header_names</span>
  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">vary</span> = <span class="ruby-identifier">headers</span>[<span class="ruby-string">'Vary'</span>]
  <span class="ruby-identifier">vary</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">%r[\s,]+/</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- vary_header_names-source -->
          
        </div>

        

        
      </div><!-- vary_header_names-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

