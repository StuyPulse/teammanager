<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class RDoc::RDoc - rdoc-3.12 Documentation</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/rdoc/rdoc.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">Object
  
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-add_generator">::add_generator</a>
    
    <li><a href="#method-c-current">::current</a>
    
    <li><a href="#method-c-current-3D">::current=</a>
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-c-reset">::reset</a>
    
    <li><a href="#method-i-document">#document</a>
    
    <li><a href="#method-i-error">#error</a>
    
    <li><a href="#method-i-gather_files">#gather_files</a>
    
    <li><a href="#method-i-generate">#generate</a>
    
    <li><a href="#method-i-handle_pipe">#handle_pipe</a>
    
    <li><a href="#method-i-install_siginfo_handler">#install_siginfo_handler</a>
    
    <li><a href="#method-i-list_files_in_directory">#list_files_in_directory</a>
    
    <li><a href="#method-i-load_options">#load_options</a>
    
    <li><a href="#method-i-normalized_file_list">#normalized_file_list</a>
    
    <li><a href="#method-i-output_flag_file">#output_flag_file</a>
    
    <li><a href="#method-i-parse_dot_doc_file">#parse_dot_doc_file</a>
    
    <li><a href="#method-i-parse_file">#parse_file</a>
    
    <li><a href="#method-i-parse_files">#parse_files</a>
    
    <li><a href="#method-i-remove_siginfo_handler">#remove_siginfo_handler</a>
    
    <li><a href="#method-i-remove_unparseable">#remove_unparseable</a>
    
    <li><a href="#method-i-setup_output_dir">#setup_output_dir</a>
    
    <li><a href="#method-i-update_output_dir">#update_output_dir</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../DEVELOPERS_rdoc.html">DEVELOPERS</a>
  
    <li class="file"><a href="../History_rdoc.html">History</a>
  
    <li class="file"><a href="../LEGAL_rdoc.html">LEGAL</a>
  
    <li class="file"><a href="../LICENSE_rdoc.html">LICENSE</a>
  
    <li class="file"><a href="../Manifest_txt.html">Manifest</a>
  
    <li class="file"><a href="../README_rdoc.html">README</a>
  
    <li class="file"><a href="../RI_rdoc.html">RI</a>
  
    <li class="file"><a href="../Rakefile.html">Rakefile</a>
  
    <li class="file"><a href="../TODO_rdoc.html">TODO</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../RDoc.html">RDoc</a>
  
    <li><a href="../RDoc/Alias.html">RDoc::Alias</a>
  
    <li><a href="../RDoc/AnonClass.html">RDoc::AnonClass</a>
  
    <li><a href="../RDoc/AnyMethod.html">RDoc::AnyMethod</a>
  
    <li><a href="../RDoc/Attr.html">RDoc::Attr</a>
  
    <li><a href="../RDoc/ClassModule.html">RDoc::ClassModule</a>
  
    <li><a href="../RDoc/CodeObject.html">RDoc::CodeObject</a>
  
    <li><a href="../RDoc/Comment.html">RDoc::Comment</a>
  
    <li><a href="../RDoc/Constant.html">RDoc::Constant</a>
  
    <li><a href="../RDoc/Context.html">RDoc::Context</a>
  
    <li><a href="../RDoc/Context/Section.html">RDoc::Context::Section</a>
  
    <li><a href="../RDoc/CrossReference.html">RDoc::CrossReference</a>
  
    <li><a href="../RDoc/ERBIO.html">RDoc::ERBIO</a>
  
    <li><a href="../RDoc/Encoding.html">RDoc::Encoding</a>
  
    <li><a href="../RDoc/Error.html">RDoc::Error</a>
  
    <li><a href="../RDoc/Gauntlet.html">RDoc::Gauntlet</a>
  
    <li><a href="../RDoc/Generator.html">RDoc::Generator</a>
  
    <li><a href="../RDoc/Generator/Darkfish.html">RDoc::Generator::Darkfish</a>
  
    <li><a href="../RDoc/Generator/JsonIndex.html">RDoc::Generator::JsonIndex</a>
  
    <li><a href="../RDoc/Generator/Markup.html">RDoc::Generator::Markup</a>
  
    <li><a href="../RDoc/Generator/RI.html">RDoc::Generator::RI</a>
  
    <li><a href="../RDoc/GhostMethod.html">RDoc::GhostMethod</a>
  
    <li><a href="../RDoc/Include.html">RDoc::Include</a>
  
    <li><a href="../RDoc/Markup.html">RDoc::Markup</a>
  
    <li><a href="../RDoc/Markup/AttrChanger.html">RDoc::Markup::AttrChanger</a>
  
    <li><a href="../RDoc/Markup/AttrSpan.html">RDoc::Markup::AttrSpan</a>
  
    <li><a href="../RDoc/Markup/Attribute.html">RDoc::Markup::Attribute</a>
  
    <li><a href="../RDoc/Markup/AttributeManager.html">RDoc::Markup::AttributeManager</a>
  
    <li><a href="../RDoc/Markup/BlankLine.html">RDoc::Markup::BlankLine</a>
  
    <li><a href="../RDoc/Markup/Document.html">RDoc::Markup::Document</a>
  
    <li><a href="../RDoc/Markup/Formatter.html">RDoc::Markup::Formatter</a>
  
    <li><a href="../RDoc/Markup/FormatterTestCase.html">RDoc::Markup::FormatterTestCase</a>
  
    <li><a href="../RDoc/Markup/Heading.html">RDoc::Markup::Heading</a>
  
    <li><a href="../RDoc/Markup/Include.html">RDoc::Markup::Include</a>
  
    <li><a href="../RDoc/Markup/IndentedParagraph.html">RDoc::Markup::IndentedParagraph</a>
  
    <li><a href="../RDoc/Markup/List.html">RDoc::Markup::List</a>
  
    <li><a href="../RDoc/Markup/ListItem.html">RDoc::Markup::ListItem</a>
  
    <li><a href="../RDoc/Markup/Paragraph.html">RDoc::Markup::Paragraph</a>
  
    <li><a href="../RDoc/Markup/Parser.html">RDoc::Markup::Parser</a>
  
    <li><a href="../RDoc/Markup/Parser/Error.html">RDoc::Markup::Parser::Error</a>
  
    <li><a href="../RDoc/Markup/Parser/ParseError.html">RDoc::Markup::Parser::ParseError</a>
  
    <li><a href="../RDoc/Markup/PreProcess.html">RDoc::Markup::PreProcess</a>
  
    <li><a href="../RDoc/Markup/Raw.html">RDoc::Markup::Raw</a>
  
    <li><a href="../RDoc/Markup/Rule.html">RDoc::Markup::Rule</a>
  
    <li><a href="../RDoc/Markup/Special.html">RDoc::Markup::Special</a>
  
    <li><a href="../RDoc/Markup/TextFormatterTestCase.html">RDoc::Markup::TextFormatterTestCase</a>
  
    <li><a href="../RDoc/Markup/ToAnsi.html">RDoc::Markup::ToAnsi</a>
  
    <li><a href="../RDoc/Markup/ToBs.html">RDoc::Markup::ToBs</a>
  
    <li><a href="../RDoc/Markup/ToHtml.html">RDoc::Markup::ToHtml</a>
  
    <li><a href="../RDoc/Markup/ToHtmlCrossref.html">RDoc::Markup::ToHtmlCrossref</a>
  
    <li><a href="../RDoc/Markup/ToHtmlSnippet.html">RDoc::Markup::ToHtmlSnippet</a>
  
    <li><a href="../RDoc/Markup/ToLabel.html">RDoc::Markup::ToLabel</a>
  
    <li><a href="../RDoc/Markup/ToRdoc.html">RDoc::Markup::ToRdoc</a>
  
    <li><a href="../RDoc/Markup/ToTableOfContents.html">RDoc::Markup::ToTableOfContents</a>
  
    <li><a href="../RDoc/Markup/ToTest.html">RDoc::Markup::ToTest</a>
  
    <li><a href="../RDoc/Markup/ToTtOnly.html">RDoc::Markup::ToTtOnly</a>
  
    <li><a href="../RDoc/Markup/Verbatim.html">RDoc::Markup::Verbatim</a>
  
    <li><a href="../RDoc/MetaMethod.html">RDoc::MetaMethod</a>
  
    <li><a href="../RDoc/MethodAttr.html">RDoc::MethodAttr</a>
  
    <li><a href="../RDoc/NormalClass.html">RDoc::NormalClass</a>
  
    <li><a href="../RDoc/NormalModule.html">RDoc::NormalModule</a>
  
    <li><a href="../RDoc/Options.html">RDoc::Options</a>
  
    <li><a href="../RDoc/Parser.html">RDoc::Parser</a>
  
    <li><a href="../RDoc/Parser/C.html">RDoc::Parser::C</a>
  
    <li><a href="../RDoc/Parser/RD.html">RDoc::Parser::RD</a>
  
    <li><a href="../RDoc/Parser/Ruby.html">RDoc::Parser::Ruby</a>
  
    <li><a href="../RDoc/Parser/RubyTools.html">RDoc::Parser::RubyTools</a>
  
    <li><a href="../RDoc/Parser/Simple.html">RDoc::Parser::Simple</a>
  
    <li><a href="../RDoc/Parser/Text.html">RDoc::Parser::Text</a>
  
    <li><a href="../RDoc/RD.html">RDoc::RD</a>
  
    <li><a href="../RDoc/RD/Inline.html">RDoc::RD::Inline</a>
  
    <li><a href="../RDoc/RDoc.html">RDoc::RDoc</a>
  
    <li><a href="../RDoc/RI.html">RDoc::RI</a>
  
    <li><a href="../RDoc/RI/Driver.html">RDoc::RI::Driver</a>
  
    <li><a href="../RDoc/RI/Driver/Error.html">RDoc::RI::Driver::Error</a>
  
    <li><a href="../RDoc/RI/Driver/NotFoundError.html">RDoc::RI::Driver::NotFoundError</a>
  
    <li><a href="../RDoc/RI/Error.html">RDoc::RI::Error</a>
  
    <li><a href="../RDoc/RI/Paths.html">RDoc::RI::Paths</a>
  
    <li><a href="../RDoc/RI/Store.html">RDoc::RI::Store</a>
  
    <li><a href="../RDoc/Require.html">RDoc::Require</a>
  
    <li><a href="../RDoc/RubyLex.html">RDoc::RubyLex</a>
  
    <li><a href="../RDoc/RubyLex/Error.html">RDoc::RubyLex::Error</a>
  
    <li><a href="../RDoc/RubyToken.html">RDoc::RubyToken</a>
  
    <li><a href="../RDoc/RubygemsHook.html">RDoc::RubygemsHook</a>
  
    <li><a href="../RDoc/SingleClass.html">RDoc::SingleClass</a>
  
    <li><a href="../RDoc/Stats.html">RDoc::Stats</a>
  
    <li><a href="../RDoc/Stats/Normal.html">RDoc::Stats::Normal</a>
  
    <li><a href="../RDoc/Stats/Quiet.html">RDoc::Stats::Quiet</a>
  
    <li><a href="../RDoc/Stats/Verbose.html">RDoc::Stats::Verbose</a>
  
    <li><a href="../RDoc/Task.html">RDoc::Task</a>
  
    <li><a href="../RDoc/Task.html">RDoc::Task</a>
  
    <li><a href="../RDoc/TestCase.html">RDoc::TestCase</a>
  
    <li><a href="../RDoc/Text.html">RDoc::Text</a>
  
    <li><a href="../RDoc/TokenStream.html">RDoc::TokenStream</a>
  
    <li><a href="../RDoc/TomDoc.html">RDoc::TomDoc</a>
  
    <li><a href="../RDoc/TopLevel.html">RDoc::TopLevel</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class RDoc::RDoc</h1>

  <div id="description" class="description">
    
<p>This is the driver for generating <a href="RDoc.html">RDoc</a> output.  It
file parsing and generation of output.</p>

<p>To use this class to generate <a href="RDoc.html">RDoc</a> output via the
API, the recommended way is:</p>

<pre>rdoc = RDoc::RDoc.new
options = rdoc.load_options # returns an RDoc::Options instance
# set extra options
rdoc.document options</pre>

<p>You can also generate output like the <code>rdoc</code> executable:</p>

<pre>rdoc = RDoc::RDoc.new
rdoc.document argv</pre>

<p>Where <code>argv</code> is an array of strings, each corresponding to an
argument you’d give rdoc on the command line.  See &lt;tt&gt;rdoc
–help&lt;tt&gt; for details.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="GENERATORS">GENERATORS
        
        <dd class="description"><p>This is the list of supported output generators</p>
        
      
      </dl>
    </section>
    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-i-exclude" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">exclude</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>File pattern to exclude</p>
        
        </div>
      </div>
      
      <div id="attribute-i-generator" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">generator</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p><a href="Generator.html">Generator</a> instance used for creating output</p>
        
        </div>
      </div>
      
      <div id="attribute-i-last_modified" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">last_modified</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Hash of files and their last modified times.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-options" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">options</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p><a href="RDoc.html">RDoc</a> options</p>
        
        </div>
      </div>
      
      <div id="attribute-i-stats" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">stats</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Accessor for statistics.  Available after each call to <a
href="RDoc.html#method-i-parse_files">#parse_files</a></p>
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-add_generator" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_generator</span><span
            class="method-args">(klass)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Add <code>klass</code> that can generate output after parsing</p>
          

          
          <div class="method-source-code" id="add_generator-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">add_generator</span>(<span class="ruby-identifier">klass</span>)
  <span class="ruby-identifier">name</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">%r^RDoc::Generator::/</span>, <span class="ruby-string">''</span>).<span class="ruby-identifier">downcase</span>
  <span class="ruby-constant">GENERATORS</span>[<span class="ruby-identifier">name</span>] = <span class="ruby-identifier">klass</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- add_generator-source -->
          
        </div>

        

        
      </div><!-- add_generator-method -->

    
      <div id="method-c-current" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Active <a href="RDoc.html">RDoc::RDoc</a> instance</p>
          

          
          <div class="method-source-code" id="current-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 72</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">current</span>
  <span class="ruby-ivar">@current</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- current-source -->
          
        </div>

        

        
      </div><!-- current-method -->

    
      <div id="method-c-current-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current=</span><span
            class="method-args">(rdoc)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Sets the active <a href="RDoc.html">RDoc::RDoc</a> instance</p>
          

          
          <div class="method-source-code" id="current-3D-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 79</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">current=</span> <span class="ruby-identifier">rdoc</span>
  <span class="ruby-ivar">@current</span> = <span class="ruby-identifier">rdoc</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- current-3D-source -->
          
        </div>

        

        
      </div><!-- current-3D-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Creates a new <a href="RDoc.html">RDoc::RDoc</a> instance.  Call <a
href="RDoc.html#method-i-document">document</a> to parse files and generate
documentation.</p>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 96</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
  <span class="ruby-ivar">@current</span>       = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@exclude</span>       = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@generator</span>     = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@last_modified</span> = {}
  <span class="ruby-ivar">@old_siginfo</span>   = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@options</span>       = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@stats</span>         = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-c-reset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reset</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Resets all internal state</p>
          

          
          <div class="method-source-code" id="reset-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 86</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">reset</span>
  <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">reset</span>
  <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span><span class="ruby-operator">::</span><span class="ruby-constant">C</span>.<span class="ruby-identifier">reset</span>
  <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">RDoc</span>.<span class="ruby-identifier">current</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- reset-source -->
          
        </div>

        

        
      </div><!-- reset-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-document" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">document</span><span
            class="method-args">(options)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Generates documentation or a coverage report depending upon the settings in
<code>options</code>.</p>

<p><code>options</code> can be either an <a
href="Options.html">RDoc::Options</a> instance or an array of strings
equivalent to the strings that would be passed on the command line like
<code>%w[-q -o doc -t My\ Doc\ Title]</code>.  <a
href="RDoc.html#method-i-document">document</a> will automatically call <a
href="Options.html#method-i-finish">RDoc::Options#finish</a> if an options
instance was given.</p>

<p>For a list of options, see either <a href="Options.html">RDoc::Options</a>
or <code>rdoc --help</code>.</p>

<p>By default, output will be stored in a directory called “doc” below the
current directory, so make sure you’re somewhere writable before invoking.</p>
          

          
          <div class="method-source-code" id="document-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 427</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">document</span> <span class="ruby-identifier">options</span>
  <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">RDoc</span>.<span class="ruby-identifier">reset</span>
  <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">RDoc</span>.<span class="ruby-identifier">current</span> = <span class="ruby-keyword">self</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">options</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">options</span>
    <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">finish</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">load_options</span>
    <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">options</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">pipe</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">handle_pipe</span>
    <span class="ruby-identifier">exit</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@exclude</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">exclude</span>

  <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span> <span class="ruby-keyword">then</span>
    <span class="ruby-ivar">@last_modified</span> = <span class="ruby-identifier">setup_output_dir</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">op_dir</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">force_update</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@start_time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>

  <span class="ruby-identifier">file_info</span> = <span class="ruby-identifier">parse_files</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">files</span>

  <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">default_title</span> = <span class="ruby-string">&quot;RDoc Documentation&quot;</span>

  <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">complete</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">visibility</span>

  <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">coverage_level</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">puts</span>

    <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">report</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">file_info</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;\nNo newer files.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">gen_klass</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">generator</span>

    <span class="ruby-ivar">@generator</span> = <span class="ruby-identifier">gen_klass</span>.<span class="ruby-identifier">new</span> <span class="ruby-ivar">@options</span>

    <span class="ruby-identifier">generate</span> <span class="ruby-identifier">file_info</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@stats</span> <span class="ruby-keyword">and</span> (<span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span> <span class="ruby-keyword">or</span> <span class="ruby-keyword">not</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span>) <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">puts</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">summary</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">exit</span> <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">fully_documented?</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">coverage_report</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- document-source -->
          
        </div>

        

        
      </div><!-- document-method -->

    
      <div id="method-i-error" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">error</span><span
            class="method-args">(msg)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Report an error message and exit</p>
          

          
          <div class="method-source-code" id="error-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 109</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">error</span>(<span class="ruby-identifier">msg</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-identifier">msg</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- error-source -->
          
        </div>

        

        
      </div><!-- error-method -->

    
      <div id="method-i-gather_files" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">gather_files</span><span
            class="method-args">(files)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Gathers a set of parseable files from the files and directories listed in
<code>files</code>.</p>
          

          
          <div class="method-source-code" id="gather_files-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 117</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">gather_files</span> <span class="ruby-identifier">files</span>
  <span class="ruby-identifier">files</span> = [<span class="ruby-string">&quot;.&quot;</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">files</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">normalized_file_list</span> <span class="ruby-identifier">files</span>, <span class="ruby-keyword">true</span>, <span class="ruby-ivar">@exclude</span>

  <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">uniq</span>

  <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">remove_unparseable</span> <span class="ruby-identifier">file_list</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- gather_files-source -->
          
        </div>

        

        
      </div><!-- gather_files-method -->

    
      <div id="method-i-generate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">generate</span><span
            class="method-args">(file_info)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Generates documentation for <code>file_info</code> (from <a
href="RDoc.html#method-i-parse_files">parse_files</a>) into the output dir
using the generator selected by the <a href="RDoc.html">RDoc</a> options</p>
          

          
          <div class="method-source-code" id="generate-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 487</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">generate</span> <span class="ruby-identifier">file_info</span>
  <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">chdir</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">op_dir</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">quiet</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;\nGenerating #{@generator.class.name.sub(/^.*::/, '')} format into #{Dir.pwd}...&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@generator</span>.<span class="ruby-identifier">generate</span> <span class="ruby-identifier">file_info</span>
    <span class="ruby-identifier">update_output_dir</span> <span class="ruby-string">'.'</span>, <span class="ruby-ivar">@start_time</span>, <span class="ruby-ivar">@last_modified</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- generate-source -->
          
        </div>

        

        
      </div><!-- generate-method -->

    
      <div id="method-i-handle_pipe" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">handle_pipe</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Turns <a href="RDoc.html">RDoc</a> from stdin into HTML</p>
          

          
          <div class="method-source-code" id="handle_pipe-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 130</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">handle_pipe</span>
  <span class="ruby-ivar">@html</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Markup</span><span class="ruby-operator">::</span><span class="ruby-constant">ToHtml</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">parser</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Text</span><span class="ruby-operator">::</span><span class="ruby-constant">MARKUP_FORMAT</span>[<span class="ruby-ivar">@options</span>.<span class="ruby-identifier">markup</span>]

  <span class="ruby-identifier">document</span> = <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">$stdin</span>.<span class="ruby-identifier">read</span>

  <span class="ruby-identifier">out</span> = <span class="ruby-ivar">@html</span>.<span class="ruby-identifier">convert</span> <span class="ruby-identifier">document</span>

  <span class="ruby-identifier">$stdout</span>.<span class="ruby-identifier">write</span> <span class="ruby-identifier">out</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- handle_pipe-source -->
          
        </div>

        

        
      </div><!-- handle_pipe-method -->

    
      <div id="method-i-install_siginfo_handler" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">install_siginfo_handler</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Installs a siginfo handler that prints the current filename.</p>
          

          
          <div class="method-source-code" id="install_siginfo_handler-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 145</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">install_siginfo_handler</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">list</span>.<span class="ruby-identifier">include?</span> <span class="ruby-string">'INFO'</span>

  <span class="ruby-ivar">@old_siginfo</span> = <span class="ruby-identifier">trap</span> <span class="ruby-string">'INFO'</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-ivar">@current</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@current</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- install_siginfo_handler-source -->
          
        </div>

        

        
      </div><!-- install_siginfo_handler-method -->

    
      <div id="method-i-list_files_in_directory" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">list_files_in_directory</span><span
            class="method-args">(dir)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Return a list of the files to be processed in a directory. We know that
this directory doesn’t have a .document file, so we’re looking for real
files. However we may well contain subdirectories which must be tested for
.document files.</p>
          

          
          <div class="method-source-code" id="list_files_in_directory-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 319</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">list_files_in_directory</span> <span class="ruby-identifier">dir</span>
  <span class="ruby-identifier">files</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-string">&quot;*&quot;</span>)

  <span class="ruby-identifier">normalized_file_list</span> <span class="ruby-identifier">files</span>, <span class="ruby-keyword">false</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">exclude</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- list_files_in_directory-source -->
          
        </div>

        

        
      </div><!-- list_files_in_directory-method -->

    
      <div id="method-i-load_options" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">load_options</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Loads options from .rdoc_options if the file exists, otherwise creates a
new <a href="Options.html">RDoc::Options</a> instance.</p>
          

          
          <div class="method-source-code" id="load_options-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 157</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">load_options</span>
  <span class="ruby-identifier">options_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span> <span class="ruby-string">'.rdoc_options'</span>
  <span class="ruby-keyword">return</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">options_file</span>

  <span class="ruby-constant">RDoc</span>.<span class="ruby-identifier">load_yaml</span>

  <span class="ruby-identifier">parse_error</span> = <span class="ruby-keyword">if</span> <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_defined?</span> <span class="ruby-value">:Psych</span> <span class="ruby-keyword">then</span>
                  <span class="ruby-constant">Psych</span><span class="ruby-operator">::</span><span class="ruby-constant">SyntaxError</span>
                <span class="ruby-keyword">else</span>
                  <span class="ruby-constant">ArgumentError</span>
                <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">options</span> = <span class="ruby-constant">YAML</span>.<span class="ruby-identifier">load_file</span> <span class="ruby-string">'.rdoc_options'</span>
  <span class="ruby-keyword">rescue</span> *<span class="ruby-identifier">parse_error</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;#{options_file} is not a valid rdoc options file&quot;</span> <span class="ruby-keyword">unless</span>
    <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Options</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">options</span>

  <span class="ruby-identifier">options</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- load_options-source -->
          
        </div>

        

        
      </div><!-- load_options-method -->

    
      <div id="method-i-normalized_file_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">normalized_file_list</span><span
            class="method-args">(relative_files, force_doc = false, exclude_pattern = nil)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Given a list of files and directories, create a list of all the Ruby files
they contain.</p>

<p>If <code>force_doc</code> is true we always add the given files, if false,
only add files that we guarantee we can parse.  It is true when looking at
files given on the command line, false when recursing through
subdirectories.</p>

<p>The effect of this is that if you want a file with a non-standard extension
parsed, you must name it explicitly.</p>
          

          
          <div class="method-source-code" id="normalized_file_list-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 278</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">normalized_file_list</span>(<span class="ruby-identifier">relative_files</span>, <span class="ruby-identifier">force_doc</span> = <span class="ruby-keyword">false</span>,
                         <span class="ruby-identifier">exclude_pattern</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">file_list</span> = []

  <span class="ruby-identifier">relative_files</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">rel_file_name</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">exclude_pattern</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">exclude_pattern</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">rel_file_name</span>
    <span class="ruby-identifier">stat</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span> <span class="ruby-identifier">rel_file_name</span> <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">next</span>

    <span class="ruby-keyword">case</span> <span class="ruby-identifier">type</span> = <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">ftype</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;file&quot;</span> <span class="ruby-keyword">then</span>
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">last_modified</span> = <span class="ruby-ivar">@last_modified</span>[<span class="ruby-identifier">rel_file_name</span>] <span class="ruby-keyword">and</span>
              <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">mtime</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">last_modified</span>.<span class="ruby-identifier">to_i</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">force_doc</span> <span class="ruby-keyword">or</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">can_parse</span>(<span class="ruby-identifier">rel_file_name</span>) <span class="ruby-keyword">then</span>
        <span class="ruby-identifier">file_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rel_file_name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">%r^\.\//</span>, <span class="ruby-string">''</span>)
        <span class="ruby-ivar">@last_modified</span>[<span class="ruby-identifier">rel_file_name</span>] = <span class="ruby-identifier">stat</span>.<span class="ruby-identifier">mtime</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;directory&quot;</span> <span class="ruby-keyword">then</span>
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">rel_file_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;CVS&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">rel_file_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;.svn&quot;</span>

      <span class="ruby-identifier">dot_doc</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">rel_file_name</span>, <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">DOT_DOC_FILENAME</span>

      <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span> <span class="ruby-identifier">dot_doc</span> <span class="ruby-keyword">then</span>
        <span class="ruby-identifier">file_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">parse_dot_doc_file</span>(<span class="ruby-identifier">rel_file_name</span>, <span class="ruby-identifier">dot_doc</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">file_list</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">list_files_in_directory</span>(<span class="ruby-identifier">rel_file_name</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;I can't deal with a #{type} #{rel_file_name}&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">flatten</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- normalized_file_list-source -->
          
        </div>

        

        
      </div><!-- normalized_file_list-method -->

    
      <div id="method-i-output_flag_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">output_flag_file</span><span
            class="method-args">(op_dir)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Return the path name of the flag file in an output directory.</p>
          

          
          <div class="method-source-code" id="output_flag_file-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 243</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">output_flag_file</span>(<span class="ruby-identifier">op_dir</span>)
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">op_dir</span>, <span class="ruby-string">&quot;created.rid&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- output_flag_file-source -->
          
        </div>

        

        
      </div><!-- output_flag_file-method -->

    
      <div id="method-i-parse_dot_doc_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_dot_doc_file</span><span
            class="method-args">(in_dir, filename)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The .document file contains a list of file and directory name patterns,
representing candidates for documentation. It may also contain comments
(starting with ‘#’)</p>
          

          
          <div class="method-source-code" id="parse_dot_doc_file-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 252</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_dot_doc_file</span> <span class="ruby-identifier">in_dir</span>, <span class="ruby-identifier">filename</span>
  <span class="ruby-comment"># read and strip comments</span>
  <span class="ruby-identifier">patterns</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">filename</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-node">%r#.*/</span>, <span class="ruby-string">''</span>)

  <span class="ruby-identifier">result</span> = []

  <span class="ruby-identifier">patterns</span>.<span class="ruby-identifier">split</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">patt</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">candidates</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">glob</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">in_dir</span>, <span class="ruby-identifier">patt</span>))
    <span class="ruby-identifier">result</span>.<span class="ruby-identifier">concat</span> <span class="ruby-identifier">normalized_file_list</span>(<span class="ruby-identifier">candidates</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">result</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- parse_dot_doc_file-source -->
          
        </div>

        

        
      </div><!-- parse_dot_doc_file-method -->

    
      <div id="method-i-parse_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_file</span><span
            class="method-args">(filename)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Parses <code>filename</code> and returns an <a
href="TopLevel.html">RDoc::TopLevel</a></p>
          

          
          <div class="method-source-code" id="parse_file-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 328</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_file</span> <span class="ruby-identifier">filename</span>
    <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-constant">Encoding</span>) <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">encoding</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">encoding</span>
      <span class="ruby-identifier">filename</span> = <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">encode</span> <span class="ruby-identifier">encoding</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">add_file</span> <span class="ruby-identifier">filename</span>

    <span class="ruby-identifier">content</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Encoding</span>.<span class="ruby-identifier">read_file</span> <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">encoding</span>

    <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">content</span>

    <span class="ruby-identifier">top_level</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">TopLevel</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">filename</span>

    <span class="ruby-identifier">parser</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Parser</span>.<span class="ruby-identifier">for</span> <span class="ruby-identifier">top_level</span>, <span class="ruby-identifier">filename</span>, <span class="ruby-identifier">content</span>, <span class="ruby-ivar">@options</span>, <span class="ruby-ivar">@stats</span>

    <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">parser</span>

    <span class="ruby-identifier">parser</span>.<span class="ruby-identifier">scan</span>

    <span class="ruby-comment"># restart documentation for the classes &amp; modules found</span>
    <span class="ruby-identifier">top_level</span>.<span class="ruby-identifier">classes_or_modules</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cm</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">cm</span>.<span class="ruby-identifier">done_documenting</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">top_level</span>

  <span class="ruby-keyword">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Before reporting this, could you check that the file you're documenting
has proper syntax:

  #{Gem.ruby} -c #{filename}

RDoc is not a full Ruby parser and will fail when fed invalid ruby programs.

The internal error was:

\t(#{e.class}) #{e.message}

&quot;</span>

    <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">backtrace</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n\t&quot;</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">$DEBUG_RDOC</span>

    <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span>
    <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span></pre>
          </div><!-- parse_file-source -->
          
        </div>

        

        
      </div><!-- parse_file-method -->

    
      <div id="method-i-parse_files" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parse_files</span><span
            class="method-args">(files)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Parse each file on the command line, recursively entering directories.</p>
          

          
          <div class="method-source-code" id="parse_files-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 379</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parse_files</span> <span class="ruby-identifier">files</span>
  <span class="ruby-identifier">file_list</span> = <span class="ruby-identifier">gather_files</span> <span class="ruby-identifier">files</span>
  <span class="ruby-ivar">@stats</span> = <span class="ruby-constant">RDoc</span><span class="ruby-operator">::</span><span class="ruby-constant">Stats</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">size</span>, <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">verbosity</span>

  <span class="ruby-keyword">return</span> [] <span class="ruby-keyword">if</span> <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-identifier">file_info</span> = []

  <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">begin_adding</span>

  <span class="ruby-identifier">file_info</span> = <span class="ruby-identifier">file_list</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">filename</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@current</span> = <span class="ruby-identifier">filename</span>
    <span class="ruby-identifier">parse_file</span> <span class="ruby-identifier">filename</span>
  <span class="ruby-keyword">end</span>.<span class="ruby-identifier">compact</span>

  <span class="ruby-ivar">@stats</span>.<span class="ruby-identifier">done_adding</span>

  <span class="ruby-identifier">file_info</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- parse_files-source -->
          
        </div>

        

        
      </div><!-- parse_files-method -->

    
      <div id="method-i-remove_siginfo_handler" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_siginfo_handler</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Removes a siginfo handler and replaces the previous</p>
          

          
          <div class="method-source-code" id="remove_siginfo_handler-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 501</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_siginfo_handler</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">list</span>.<span class="ruby-identifier">key?</span> <span class="ruby-string">'INFO'</span>

  <span class="ruby-identifier">handler</span> = <span class="ruby-ivar">@old_siginfo</span> <span class="ruby-operator">||</span> <span class="ruby-string">'DEFAULT'</span>

  <span class="ruby-identifier">trap</span> <span class="ruby-string">'INFO'</span>, <span class="ruby-identifier">handler</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- remove_siginfo_handler-source -->
          
        </div>

        

        
      </div><!-- remove_siginfo_handler-method -->

    
      <div id="method-i-remove_unparseable" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_unparseable</span><span
            class="method-args">(files)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Removes file extensions known to be unparseable from <code>files</code> and
TAGS files for emacs and vim.</p>
          

          
          <div class="method-source-code" id="remove_unparseable-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 403</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_unparseable</span> <span class="ruby-identifier">files</span>
  <span class="ruby-identifier">files</span>.<span class="ruby-identifier">reject</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">file</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r\.(?:class|eps|erb|scpt\.txt|ttf|yml)$/</span> <span class="ruby-keyword">or</span>
      (<span class="ruby-identifier">file</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%rtags$/</span> <span class="ruby-keyword">and</span>
       <span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>, <span class="ruby-string">'rb'</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
         <span class="ruby-identifier">io</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">100</span>) <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r\A(\f\n[^,]+,\d+$|!_TAG_)/</span>
       })
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- remove_unparseable-source -->
          
        </div>

        

        
      </div><!-- remove_unparseable-method -->

    
      <div id="method-i-setup_output_dir" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">setup_output_dir</span><span
            class="method-args">(dir, force)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Create an output dir if it doesn’t exist. If it does exist, but doesn’t
contain the flag file <code>created.rid</code> then we refuse to use it, as
we may clobber some manually generated documentation</p>
          

          
          <div class="method-source-code" id="setup_output_dir-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 185</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">setup_output_dir</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">force</span>)
    <span class="ruby-identifier">flag_file</span> = <span class="ruby-identifier">output_flag_file</span> <span class="ruby-identifier">dir</span>

    <span class="ruby-identifier">last</span> = {}

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> <span class="ruby-keyword">then</span>
      <span class="ruby-comment"># do nothing</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span> <span class="ruby-identifier">dir</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">error</span> <span class="ruby-node">&quot;#{dir} exists and is not a directory&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span> <span class="ruby-identifier">dir</span>

      <span class="ruby-keyword">begin</span>
        <span class="ruby-identifier">open</span> <span class="ruby-identifier">flag_file</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword">unless</span> <span class="ruby-identifier">force</span> <span class="ruby-keyword">then</span>
            <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">gets</span>

            <span class="ruby-identifier">io</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
              <span class="ruby-identifier">file</span>, <span class="ruby-identifier">time</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span> <span class="ruby-string">&quot;\t&quot;</span>, <span class="ruby-value">2</span>
              <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">time</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">next</span>
              <span class="ruby-identifier">last</span>[<span class="ruby-identifier">file</span>] = <span class="ruby-identifier">time</span>
            <span class="ruby-keyword">end</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">rescue</span> <span class="ruby-constant">SystemCallError</span>, <span class="ruby-constant">TypeError</span>
        <span class="ruby-identifier">error</span> <span class="ruby-string">&quot;
Directory #{dir} already exists, but it looks like it isn't an RDoc directory.

Because RDoc doesn't want to risk destroying any of your existing files,
you'll need to specify a different output directory name (using the --op &lt;dir&gt;
option)

&quot;</span>
      <span class="ruby-keyword">end</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">force_output</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">mkdir_p</span> <span class="ruby-identifier">dir</span>
      <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">touch</span> <span class="ruby-identifier">output_flag_file</span> <span class="ruby-identifier">dir</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">last</span>
  <span class="ruby-keyword">end</span></pre>
          </div><!-- setup_output_dir-source -->
          
        </div>

        

        
      </div><!-- setup_output_dir-method -->

    
      <div id="method-i-update_output_dir" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update_output_dir</span><span
            class="method-args">(op_dir, time, last = {})</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Update the flag file in an output directory.</p>
          

          
          <div class="method-source-code" id="update_output_dir-source">
            <pre><span class="ruby-comment"># File lib/rdoc/rdoc.rb, line 229</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update_output_dir</span>(<span class="ruby-identifier">op_dir</span>, <span class="ruby-identifier">time</span>, <span class="ruby-identifier">last</span> = {})
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">dry_run</span> <span class="ruby-keyword">or</span> <span class="ruby-keyword">not</span> <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">update_output_dir</span>

  <span class="ruby-identifier">open</span> <span class="ruby-identifier">output_flag_file</span>(<span class="ruby-identifier">op_dir</span>), <span class="ruby-string">&quot;w&quot;</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-identifier">time</span>.<span class="ruby-identifier">rfc2822</span>
    <span class="ruby-identifier">last</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>, <span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{n}\t#{t.rfc2822}&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- update_output_dir-source -->
          
        </div>

        

        
      </div><!-- update_output_dir-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

