<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>module ActiveModel::Validations::ClassMethods - activemodel-3.2.3 Documentation</title>

<link type="text/css" media="screen" href="../../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
</script>

<script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../../js/darkfish.js"></script>


<body id="top" class="module">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../../index.html">Home</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/active_model/validations.rb
    <li>lib/active_model/validations/validates.rb
    <li>lib/active_model/validations/with.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-i-_validates_default_keys">#_validates_default_keys</a>
    
    <li><a href="#method-i-attribute_method-3F">#attribute_method?</a>
    
    <li><a href="#method-i-inherited">#inherited</a>
    
    <li><a href="#method-i-validate">#validate</a>
    
    <li><a href="#method-i-validates">#validates</a>
    
    <li><a href="#method-i-validates-21">#validates!</a>
    
    <li><a href="#method-i-validates_each">#validates_each</a>
    
    <li><a href="#method-i-validates_with">#validates_with</a>
    
    <li><a href="#method-i-validators">#validators</a>
    
    <li><a href="#method-i-validators_on">#validators_on</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    
    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../../ActiveModel.html">ActiveModel</a>
  
    <li><a href="../../ActiveModel/AttributeMethods.html">ActiveModel::AttributeMethods</a>
  
    <li><a href="../../ActiveModel/AttributeMethods/ClassMethods.html">ActiveModel::AttributeMethods::ClassMethods</a>
  
    <li><a href="../../ActiveModel/AttributeMethods/ClassMethods/AttributeMethodMatcher.html">ActiveModel::AttributeMethods::ClassMethods::AttributeMethodMatcher</a>
  
    <li><a href="../../ActiveModel/BlockValidator.html">ActiveModel::BlockValidator</a>
  
    <li><a href="../../ActiveModel/Callbacks.html">ActiveModel::Callbacks</a>
  
    <li><a href="../../ActiveModel/Conversion.html">ActiveModel::Conversion</a>
  
    <li><a href="../../ActiveModel/Dirty.html">ActiveModel::Dirty</a>
  
    <li><a href="../../ActiveModel/EachValidator.html">ActiveModel::EachValidator</a>
  
    <li><a href="../../ActiveModel/Errors.html">ActiveModel::Errors</a>
  
    <li><a href="../../ActiveModel/Lint.html">ActiveModel::Lint</a>
  
    <li><a href="../../ActiveModel/Lint/Tests.html">ActiveModel::Lint::Tests</a>
  
    <li><a href="../../ActiveModel/MassAssignmentSecurity.html">ActiveModel::MassAssignmentSecurity</a>
  
    <li><a href="../../ActiveModel/MassAssignmentSecurity/BlackList.html">ActiveModel::MassAssignmentSecurity::BlackList</a>
  
    <li><a href="../../ActiveModel/MassAssignmentSecurity/ClassMethods.html">ActiveModel::MassAssignmentSecurity::ClassMethods</a>
  
    <li><a href="../../ActiveModel/MassAssignmentSecurity/Error.html">ActiveModel::MassAssignmentSecurity::Error</a>
  
    <li><a href="../../ActiveModel/MassAssignmentSecurity/LoggerSanitizer.html">ActiveModel::MassAssignmentSecurity::LoggerSanitizer</a>
  
    <li><a href="../../ActiveModel/MassAssignmentSecurity/PermissionSet.html">ActiveModel::MassAssignmentSecurity::PermissionSet</a>
  
    <li><a href="../../ActiveModel/MassAssignmentSecurity/Sanitizer.html">ActiveModel::MassAssignmentSecurity::Sanitizer</a>
  
    <li><a href="../../ActiveModel/MassAssignmentSecurity/StrictSanitizer.html">ActiveModel::MassAssignmentSecurity::StrictSanitizer</a>
  
    <li><a href="../../ActiveModel/MassAssignmentSecurity/WhiteList.html">ActiveModel::MassAssignmentSecurity::WhiteList</a>
  
    <li><a href="../../ActiveModel/MissingAttributeError.html">ActiveModel::MissingAttributeError</a>
  
    <li><a href="../../ActiveModel/Name.html">ActiveModel::Name</a>
  
    <li><a href="../../ActiveModel/Naming.html">ActiveModel::Naming</a>
  
    <li><a href="../../ActiveModel/Observer.html">ActiveModel::Observer</a>
  
    <li><a href="../../ActiveModel/ObserverArray.html">ActiveModel::ObserverArray</a>
  
    <li><a href="../../ActiveModel/Observing.html">ActiveModel::Observing</a>
  
    <li><a href="../../ActiveModel/Observing/ClassMethods.html">ActiveModel::Observing::ClassMethods</a>
  
    <li><a href="../../ActiveModel/SecurePassword.html">ActiveModel::SecurePassword</a>
  
    <li><a href="../../ActiveModel/SecurePassword/ClassMethods.html">ActiveModel::SecurePassword::ClassMethods</a>
  
    <li><a href="../../ActiveModel/SecurePassword/InstanceMethodsOnActivation.html">ActiveModel::SecurePassword::InstanceMethodsOnActivation</a>
  
    <li><a href="../../ActiveModel/Serialization.html">ActiveModel::Serialization</a>
  
    <li><a href="../../ActiveModel/Serializers.html">ActiveModel::Serializers</a>
  
    <li><a href="../../ActiveModel/Serializers/JSON.html">ActiveModel::Serializers::JSON</a>
  
    <li><a href="../../ActiveModel/Serializers/Xml.html">ActiveModel::Serializers::Xml</a>
  
    <li><a href="../../ActiveModel/StrictValidationFailed.html">ActiveModel::StrictValidationFailed</a>
  
    <li><a href="../../ActiveModel/Translation.html">ActiveModel::Translation</a>
  
    <li><a href="../../ActiveModel/Validations.html">ActiveModel::Validations</a>
  
    <li><a href="../../ActiveModel/Validations/AcceptanceValidator.html">ActiveModel::Validations::AcceptanceValidator</a>
  
    <li><a href="../../ActiveModel/Validations/Callbacks.html">ActiveModel::Validations::Callbacks</a>
  
    <li><a href="../../ActiveModel/Validations/Callbacks/ClassMethods.html">ActiveModel::Validations::Callbacks::ClassMethods</a>
  
    <li><a href="../../ActiveModel/Validations/ClassMethods.html">ActiveModel::Validations::ClassMethods</a>
  
    <li><a href="../../ActiveModel/Validations/ConfirmationValidator.html">ActiveModel::Validations::ConfirmationValidator</a>
  
    <li><a href="../../ActiveModel/Validations/ExclusionValidator.html">ActiveModel::Validations::ExclusionValidator</a>
  
    <li><a href="../../ActiveModel/Validations/FormatValidator.html">ActiveModel::Validations::FormatValidator</a>
  
    <li><a href="../../ActiveModel/Validations/HelperMethods.html">ActiveModel::Validations::HelperMethods</a>
  
    <li><a href="../../ActiveModel/Validations/InclusionValidator.html">ActiveModel::Validations::InclusionValidator</a>
  
    <li><a href="../../ActiveModel/Validations/LengthValidator.html">ActiveModel::Validations::LengthValidator</a>
  
    <li><a href="../../ActiveModel/Validations/NumericalityValidator.html">ActiveModel::Validations::NumericalityValidator</a>
  
    <li><a href="../../ActiveModel/Validations/PresenceValidator.html">ActiveModel::Validations::PresenceValidator</a>
  
    <li><a href="../../ActiveModel/Validations/WithValidator.html">ActiveModel::Validations::WithValidator</a>
  
    <li><a href="../../ActiveModel/Validator.html">ActiveModel::Validator</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="module">module ActiveModel::Validations::ClassMethods</h1>

  <div id="description" class="description">
    
  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-attribute_method-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">attribute_method?</span><span
            class="method-args">(attribute)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Check if method is an attribute method or not.</p>
          

          
          <div class="method-source-code" id="attribute_method-3F-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations.rb, line 156</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">attribute_method?</span>(<span class="ruby-identifier">attribute</span>)
  <span class="ruby-identifier">method_defined?</span>(<span class="ruby-identifier">attribute</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- attribute_method-3F-source -->
          
        </div>

        

        
      </div><!-- attribute_method-3F-method -->

    
      <div id="method-i-inherited" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inherited</span><span
            class="method-args">(base)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Copy validators on inheritance.</p>
          

          
          <div class="method-source-code" id="inherited-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inherited</span>(<span class="ruby-identifier">base</span>)
  <span class="ruby-identifier">dup</span> = <span class="ruby-identifier">_validators</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">base</span>.<span class="ruby-identifier">_validators</span> = <span class="ruby-identifier">dup</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">dup</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">dup</span> }
  <span class="ruby-keyword">super</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- inherited-source -->
          
        </div>

        

        
      </div><!-- inherited-method -->

    
      <div id="method-i-validate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validate</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Adds a validation method or block to the class. This is useful when
overriding the <code>validate</code> instance method becomes too unwieldy
and you’re looking for more descriptive declaration of your validations.</p>

<p>This can be done with a symbol pointing to a method:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Comment</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">Validations</span>

  <span class="ruby-identifier">validate</span> :<span class="ruby-identifier">must_be_friends</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">must_be_friends</span>
    <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(:<span class="ruby-identifier">base</span>, <span class="ruby-string">&quot;Must be friends to leave a comment&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">commenter</span>.<span class="ruby-identifier">friend_of?</span>(<span class="ruby-identifier">commentee</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>With a block which is passed with the current record to be validated:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Comment</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">Validations</span>

  <span class="ruby-identifier">validate</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">comment</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">comment</span>.<span class="ruby-identifier">must_be_friends</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">def</span> <span class="ruby-identifier">must_be_friends</span>
    <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(:<span class="ruby-identifier">base</span>, <span class="ruby-string">&quot;Must be friends to leave a comment&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">commenter</span>.<span class="ruby-identifier">friend_of?</span>(<span class="ruby-identifier">commentee</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Or with a block where self points to the current record to be validated:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Comment</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">Validations</span>

  <span class="ruby-identifier">validate</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(:<span class="ruby-identifier">base</span>, <span class="ruby-string">&quot;Must be friends to leave a comment&quot;</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">commenter</span>.<span class="ruby-identifier">friend_of?</span>(<span class="ruby-identifier">commentee</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
          

          
          <div class="method-source-code" id="validate-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validate</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">extract_options!</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:on</span>)
    <span class="ruby-identifier">options</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">options</span>[<span class="ruby-value">:if</span>] = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">wrap</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:if</span>])
    <span class="ruby-identifier">options</span>[<span class="ruby-value">:if</span>].<span class="ruby-identifier">unshift</span>(<span class="ruby-node">&quot;validation_context == :#{options[:on]}&quot;</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">options</span>
  <span class="ruby-identifier">set_callback</span>(<span class="ruby-value">:validate</span>, *<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- validate-source -->
          
        </div>

        

        
      </div><!-- validate-method -->

    
      <div id="method-i-validates" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validates</span><span
            class="method-args">(*attributes)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is a shortcut to all default validators and any custom
validator classes ending in ‘Validator’. Note that Rails default validators
can be overridden inside specific classes by creating custom validator
classes in their place such as <a
href="PresenceValidator.html">PresenceValidator</a>.</p>

<p>Examples of using the default rails validators:</p>

<pre class="ruby"><span class="ruby-identifier">validates</span> :<span class="ruby-identifier">terms</span>, :<span class="ruby-identifier">acceptance</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">password</span>, :<span class="ruby-identifier">confirmation</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">username</span>, :<span class="ruby-identifier">exclusion</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-keyword">in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w(admin superuser)</span> }
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">email</span>, :<span class="ruby-identifier">format</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">with</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp">%r\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/</span>, :<span class="ruby-identifier">on</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">create</span> }
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">age</span>, :<span class="ruby-identifier">inclusion</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-keyword">in</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">9</span> }
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">first_name</span>, :<span class="ruby-identifier">length</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">30</span> }
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">age</span>, :<span class="ruby-identifier">numericality</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">username</span>, :<span class="ruby-identifier">presence</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">username</span>, :<span class="ruby-identifier">uniqueness</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
</pre>

<p>The power of the <code>validates</code> method comes when using custom
validators and default validators in one call for a given attribute e.g.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">EmailValidator</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">EachValidator</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">validate_each</span>(<span class="ruby-identifier">record</span>, <span class="ruby-identifier">attribute</span>, <span class="ruby-identifier">value</span>)
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span> <span class="ruby-identifier">attribute</span>, (<span class="ruby-identifier">options</span>[:<span class="ruby-identifier">message</span>] <span class="ruby-operator">||</span> <span class="ruby-string">&quot;is not an email&quot;</span>) <span class="ruby-keyword">unless</span>
      <span class="ruby-identifier">value</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z/</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">Validations</span>
  <span class="ruby-identifier">attr_accessor</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">email</span>

  <span class="ruby-identifier">validates</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">presence</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, :<span class="ruby-identifier">uniqueness</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, :<span class="ruby-identifier">length</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-identifier">maximum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">100</span> }
  <span class="ruby-identifier">validates</span> :<span class="ruby-identifier">email</span>, :<span class="ruby-identifier">presence</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, :<span class="ruby-identifier">email</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>
</pre>

<p><a href="../Validator.html">Validator</a> classes may also exist within the
class being validated allowing custom modules of validators to be included
as needed e.g.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Film</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">Validations</span>

  <span class="ruby-keyword">class</span> <span class="ruby-constant">TitleValidator</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">EachValidator</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier">validate_each</span>(<span class="ruby-identifier">record</span>, <span class="ruby-identifier">attribute</span>, <span class="ruby-identifier">value</span>)
      <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span> <span class="ruby-identifier">attribute</span>, <span class="ruby-string">&quot;must start with 'the'&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">%r\Athe/</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">validates</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Additionally validator classes may be in another namespace and still used
within any class.</p>

<pre class="ruby"><span class="ruby-identifier">validates</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-string">'film/title'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
</pre>

<p>The validators hash can also handle regular expressions, ranges, arrays and
strings in shortcut form, e.g.</p>

<pre class="ruby"><span class="ruby-identifier">validates</span> :<span class="ruby-identifier">email</span>, :<span class="ruby-identifier">format</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-regexp">%r@/</span>
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">gender</span>, :<span class="ruby-identifier">inclusion</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">%w(male female)</span>
<span class="ruby-identifier">validates</span> :<span class="ruby-identifier">password</span>, :<span class="ruby-identifier">length</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span><span class="ruby-operator">..</span><span class="ruby-value">20</span>
</pre>

<p>When using shortcut form, ranges and arrays are passed to your validator’s
initializer as +<a href="http://:in">options</a>+ while other types
including regular expressions and strings are passed as +<a
href="http://:with">options</a>+</p>

<p>Finally, the options <code>:if</code>, <code>:unless</code>,
<code>:on</code>, <code>:allow_blank</code>, <code>:allow_nil</code> and
<code>:strict</code> can be given to one specific validator, as a hash:</p>

<pre class="ruby"><span class="ruby-identifier">validates</span> :<span class="ruby-identifier">password</span>, :<span class="ruby-identifier">presence</span> =<span class="ruby-operator">&gt;</span> { :<span class="ruby-keyword">if</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">password_required?</span> }, :<span class="ruby-identifier">confirmation</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>
</pre>

<p>Or to all at the same time:</p>

<pre class="ruby"><span class="ruby-identifier">validates</span> :<span class="ruby-identifier">password</span>, :<span class="ruby-identifier">presence</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, :<span class="ruby-identifier">confirmation</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>, :<span class="ruby-keyword">if</span> =<span class="ruby-operator">&gt;</span> :<span class="ruby-identifier">password_required?</span>
</pre>
          

          
          <div class="method-source-code" id="validates-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations/validates.rb, line 81</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates</span>(*<span class="ruby-identifier">attributes</span>)
  <span class="ruby-identifier">defaults</span> = <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">extract_options!</span>
  <span class="ruby-identifier">validations</span> = <span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">slice!</span>(*<span class="ruby-identifier">_validates_default_keys</span>)

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;You need to supply at least one attribute&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;You need to supply at least one validation&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">validations</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-value">:attributes</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">attributes</span>)

  <span class="ruby-identifier">validations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">options</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">key</span> = <span class="ruby-node">&quot;#{key.to_s.camelize}Validator&quot;</span>

    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">validator</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">'::'</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">constantize</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NameError</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Unknown validator: '#{key}'&quot;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">validates_with</span>(<span class="ruby-identifier">validator</span>, <span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">_parse_validates_options</span>(<span class="ruby-identifier">options</span>)))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- validates-source -->
          
        </div>

        

        
      </div><!-- validates-method -->

    
      <div id="method-i-validates-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validates!</span><span
            class="method-args">(*attributes)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>This method is used to define validation that cannot be corrected by end
user and is considered exceptional. So each validator defined with bang or
<code>:strict</code> option set to <code>true</code> will always raise
<code>ActiveModel::StrictValidationFailed</code> instead of adding error
when validation fails. See <code>validates</code> for more information
about validation itself.</p>
          

          
          <div class="method-source-code" id="validates-21-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations/validates.rb, line 109</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates!</span>(*<span class="ruby-identifier">attributes</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">extract_options!</span>
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:strict</span>] = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">validates</span>(*(<span class="ruby-identifier">attributes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">options</span>))
<span class="ruby-keyword">end</span></pre>
          </div><!-- validates-21-source -->
          
        </div>

        

        
      </div><!-- validates-21-method -->

    
      <div id="method-i-validates_each" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validates_each</span><span
            class="method-args">(*attr_names, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Validates each attribute against a block.</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">Validations</span>

  <span class="ruby-identifier">attr_accessor</span> :<span class="ruby-identifier">first_name</span>, :<span class="ruby-identifier">last_name</span>

  <span class="ruby-identifier">validates_each</span> :<span class="ruby-identifier">first_name</span>, :<span class="ruby-identifier">last_name</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">record</span>, <span class="ruby-identifier">attr</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">record</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span> <span class="ruby-identifier">attr</span>, <span class="ruby-string">'starts with z.'</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">zz</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Options:</p>
<ul><li>
<p><code>:on</code> - Specifies the context where this validation is active
(e.g. <code>:on =&gt; :create</code> or <code>:on =&gt;
:custom_validation_context</code>)</p>
</li><li>
<p><code>:allow_nil</code> - Skip validation if attribute is <code>nil</code>.</p>
</li><li>
<p><code>:allow_blank</code> - Skip validation if attribute is blank.</p>
</li><li>
<p><code>:if</code> - Specifies a method, proc or string to call to determine
if the validation should occur (e.g. <code>:if =&gt;
:allow_validation</code>, or <code>:if =&gt; Proc.new { |user|
user.signup_step &gt; 2 }</code>). The method, proc or string should return
or evaluate to a true or false value.</p>
</li><li>
<p><code>:unless</code> - Specifies a method, proc or string to call to
determine if the validation should not occur (e.g. <code>:unless =&gt;
:skip_validation</code>, or <code>:unless =&gt; Proc.new { |user|
user.signup_step &lt;= 2 }</code>). The method, proc or string should
return or evaluate to a true or false value.</p>
</li></ul>
          

          
          <div class="method-source-code" id="validates_each-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations.rb, line 86</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">attr_names</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">extract_options!</span>.<span class="ruby-identifier">symbolize_keys</span>
  <span class="ruby-identifier">validates_with</span> <span class="ruby-constant">BlockValidator</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:attributes</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">attr_names</span>.<span class="ruby-identifier">flatten</span>), &amp;<span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- validates_each-source -->
          
        </div>

        

        
      </div><!-- validates_each-method -->

    
      <div id="method-i-validates_with" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validates_with</span><span
            class="method-args">(*args, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>If you pass any additional configuration options, they will be passed to
the class and available as <code>options</code>:</p>

<pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">Person</span>
  <span class="ruby-identifier">include</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">Validations</span>
  <span class="ruby-identifier">validates_with</span> <span class="ruby-constant">MyValidator</span>, :<span class="ruby-identifier">my_custom_key</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;my custom value&quot;</span>
<span class="ruby-keyword">end</span>

<span class="ruby-keyword">class</span> <span class="ruby-constant">MyValidator</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">Validator</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">validate</span>(<span class="ruby-identifier">record</span>)
    <span class="ruby-identifier">options</span>[:<span class="ruby-identifier">my_custom_key</span>] <span class="ruby-comment"># =&gt; &quot;my custom value&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>
          

          
          <div class="method-source-code" id="validates_with-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations/with.rb, line 81</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_with</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">options</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">extract_options!</span>
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">klass</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">validator</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>, &amp;<span class="ruby-identifier">block</span>)
    <span class="ruby-identifier">validator</span>.<span class="ruby-identifier">setup</span>(<span class="ruby-keyword">self</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">validator</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:setup</span>)

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">validator</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:attributes</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">validator</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-identifier">validator</span>.<span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attribute</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">_validators</span>[<span class="ruby-identifier">attribute</span>.<span class="ruby-identifier">to_sym</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">validator</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">_validators</span>[<span class="ruby-keyword">nil</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">validator</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">validate</span>(<span class="ruby-identifier">validator</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- validates_with-source -->
          
        </div>

        

        
      </div><!-- validates_with-method -->

    
      <div id="method-i-validators" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validators</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>List all validators that are being used to validate the model using
<code>validates_with</code> method.</p>
          

          
          <div class="method-source-code" id="validators-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations.rb, line 144</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validators</span>
  <span class="ruby-identifier">_validators</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">uniq</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- validators-source -->
          
        </div>

        

        
      </div><!-- validators-method -->

    
      <div id="method-i-validators_on" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">validators_on</span><span
            class="method-args">(*attributes)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>List all validators that being used to validate a specific attribute.</p>
          

          
          <div class="method-source-code" id="validators_on-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations.rb, line 149</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">validators_on</span>(*<span class="ruby-identifier">attributes</span>)
  <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attribute</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">_validators</span>[<span class="ruby-identifier">attribute</span>.<span class="ruby-identifier">to_sym</span>]
  <span class="ruby-keyword">end</span>.<span class="ruby-identifier">flatten</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- validators_on-source -->
          
        </div>

        

        
      </div><!-- validators_on-method -->

    
    </section><!-- public-instance-method-details -->
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Protected Instance Methods</h3>

    
      <div id="method-i-_validates_default_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_validates_default_keys</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>When creating custom validators, it might be useful to be able to specify
additional default keys. This can be done by overwriting this method.</p>
          

          
          <div class="method-source-code" id="_validates_default_keys-source">
            <pre><span class="ruby-comment"># File lib/active_model/validations/validates.rb, line 119</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_validates_default_keys</span>
  [<span class="ruby-value">:if</span>, <span class="ruby-value">:unless</span>, <span class="ruby-value">:on</span>, <span class="ruby-value">:allow_blank</span>, <span class="ruby-value">:allow_nil</span> , <span class="ruby-value">:strict</span>]
<span class="ruby-keyword">end</span></pre>
          </div><!-- _validates_default_keys-source -->
          
        </div>

        

        
      </div><!-- _validates_default_keys-method -->

    
    </section><!-- protected-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

