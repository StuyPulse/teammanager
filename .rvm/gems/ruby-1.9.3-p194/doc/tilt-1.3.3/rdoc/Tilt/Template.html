<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class Tilt::Template - tilt-1.3.3 Documentation</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/tilt/template.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">Object
  
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-cached_evaluate">::cached_evaluate</a>
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-i-basename">#basename</a>
    
    <li><a href="#method-i-cached_evaluate">#cached_evaluate</a>
    
    <li><a href="#method-i-compiled_method">#compiled_method</a>
    
    <li><a href="#method-i-eval_file">#eval_file</a>
    
    <li><a href="#method-i-evaluate">#evaluate</a>
    
    <li><a href="#method-i-initialize_engine">#initialize_engine</a>
    
    <li><a href="#method-i-name">#name</a>
    
    <li><a href="#method-i-precompiled">#precompiled</a>
    
    <li><a href="#method-i-precompiled_postamble">#precompiled_postamble</a>
    
    <li><a href="#method-i-precompiled_preamble">#precompiled_preamble</a>
    
    <li><a href="#method-i-precompiled_template">#precompiled_template</a>
    
    <li><a href="#method-i-prepare">#prepare</a>
    
    <li><a href="#method-i-render">#render</a>
    
    <li><a href="#method-i-require_template_library">#require_template_library</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    
    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../Tilt.html">Tilt</a>
  
    <li><a href="../Tilt/BlueClothTemplate.html">Tilt::BlueClothTemplate</a>
  
    <li><a href="../Tilt/BuilderTemplate.html">Tilt::BuilderTemplate</a>
  
    <li><a href="../Tilt/Cache.html">Tilt::Cache</a>
  
    <li><a href="../Tilt/CoffeeScriptTemplate.html">Tilt::CoffeeScriptTemplate</a>
  
    <li><a href="../Tilt/CompileSite.html">Tilt::CompileSite</a>
  
    <li><a href="../Tilt/CreoleTemplate.html">Tilt::CreoleTemplate</a>
  
    <li><a href="../Tilt/ERBTemplate.html">Tilt::ERBTemplate</a>
  
    <li><a href="../Tilt/ErubisTemplate.html">Tilt::ErubisTemplate</a>
  
    <li><a href="../Tilt/HamlTemplate.html">Tilt::HamlTemplate</a>
  
    <li><a href="../Tilt/KramdownTemplate.html">Tilt::KramdownTemplate</a>
  
    <li><a href="../Tilt/LessTemplate.html">Tilt::LessTemplate</a>
  
    <li><a href="../Tilt/LiquidTemplate.html">Tilt::LiquidTemplate</a>
  
    <li><a href="../Tilt/MarkabyTemplate.html">Tilt::MarkabyTemplate</a>
  
    <li><a href="../Tilt/MarukuTemplate.html">Tilt::MarukuTemplate</a>
  
    <li><a href="../Tilt/NokogiriTemplate.html">Tilt::NokogiriTemplate</a>
  
    <li><a href="../Tilt/RDiscountTemplate.html">Tilt::RDiscountTemplate</a>
  
    <li><a href="../Tilt/RDocTemplate.html">Tilt::RDocTemplate</a>
  
    <li><a href="../Tilt/RadiusTemplate.html">Tilt::RadiusTemplate</a>
  
    <li><a href="../Tilt/RedClothTemplate.html">Tilt::RedClothTemplate</a>
  
    <li><a href="../Tilt/RedcarpetTemplate.html">Tilt::RedcarpetTemplate</a>
  
    <li><a href="../Tilt/RedcarpetTemplate/Redcarpet1.html">Tilt::RedcarpetTemplate::Redcarpet1</a>
  
    <li><a href="../Tilt/RedcarpetTemplate/Redcarpet2.html">Tilt::RedcarpetTemplate::Redcarpet2</a>
  
    <li><a href="../Tilt/SassTemplate.html">Tilt::SassTemplate</a>
  
    <li><a href="../Tilt/ScssTemplate.html">Tilt::ScssTemplate</a>
  
    <li><a href="../Tilt/StringTemplate.html">Tilt::StringTemplate</a>
  
    <li><a href="../Tilt/Template.html">Tilt::Template</a>
  
    <li><a href="../Tilt/WikiClothTemplate.html">Tilt::WikiClothTemplate</a>
  
    <li><a href="../Tilt/YajlTemplate.html">Tilt::YajlTemplate</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class Tilt::Template</h1>

  <div id="description" class="description">
    
<p>Base class for template implementations. Subclasses must implement the <a
href="Template.html#method-i-prepare">prepare</a> method and one of the <a
href="Template.html#method-i-evaluate">evaluate</a> or <a
href="Template.html#method-i-precompiled_template">precompiled_template</a>
methods.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-c-default_mime_type" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">default_mime_type</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-engine_initialized" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">engine_initialized</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-engine_initialized-3F" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">engine_initialized?</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-data" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">data</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p><a href="Template.html">Template</a> source; loaded from a file or given
directly.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-file" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">file</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The name of the file where the template data was loaded from.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-line" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">line</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The line number in <a href="Template.html#attribute-i-file">file</a> where
template data was loaded from.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-options" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">options</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>A Hash of template engine specific options. This is passed directly to the
underlying engine and is not used by the generic template interface.</p>
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(file=nil, line=1, options={}, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Create a new template with the file, line, and options specified. By
default, template data is read from the file. When a block is given, it
should read template data and return as a String. When file is nil, a block
is required.</p>

<p>All arguments are optional.</p>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 38</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">file</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">line</span>=<span class="ruby-value">1</span>, <span class="ruby-identifier">options</span>={}, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@file</span>, <span class="ruby-ivar">@line</span>, <span class="ruby-ivar">@options</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-value">1</span>, {}

  [<span class="ruby-identifier">options</span>, <span class="ruby-identifier">line</span>, <span class="ruby-identifier">file</span>].<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">case</span>
    <span class="ruby-keyword">when</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)  ; <span class="ruby-ivar">@file</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_str</span>
    <span class="ruby-keyword">when</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_int</span>)  ; <span class="ruby-ivar">@line</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_int</span>
    <span class="ruby-keyword">when</span> <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>) ; <span class="ruby-ivar">@options</span> = <span class="ruby-identifier">arg</span>.<span class="ruby-identifier">to_hash</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-keyword">else</span> <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;file or block required&quot;</span> <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@file</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">block</span>).<span class="ruby-identifier">nil?</span>

  <span class="ruby-comment"># call the initialize_engine method if this is the very first time</span>
  <span class="ruby-comment"># an instance of this class has been created.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">engine_initialized?</span>
    <span class="ruby-identifier">initialize_engine</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">engine_initialized</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># used to hold compiled template methods</span>
  <span class="ruby-ivar">@compiled_method</span> = {}

  <span class="ruby-comment"># used on 1.9 to set the encoding if it is not set elsewhere (like a magic comment)</span>
  <span class="ruby-comment"># currently only used if template compiles to ruby</span>
  <span class="ruby-ivar">@default_encoding</span> = <span class="ruby-ivar">@options</span>.<span class="ruby-identifier">delete</span> <span class="ruby-value">:default_encoding</span>

  <span class="ruby-comment"># load template data and prepare (uses binread to avoid encoding issues)</span>
  <span class="ruby-ivar">@reader</span> = <span class="ruby-identifier">block</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">lambda</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:binread</span>) <span class="ruby-operator">?</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">binread</span>(<span class="ruby-ivar">@file</span>) <span class="ruby-operator">:</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">read</span>(<span class="ruby-ivar">@file</span>) }
  <span class="ruby-ivar">@data</span> = <span class="ruby-ivar">@reader</span>.<span class="ruby-identifier">call</span>(<span class="ruby-keyword">self</span>)
  <span class="ruby-identifier">prepare</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="protected-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Protected Class Methods</h3>

    
      <div id="method-c-cached_evaluate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cached_evaluate</span><span
            class="method-args">(scope, locals, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Redefine itself to use method compilation the next time:</p>
          

          
          <div class="method-source-code" id="cached_evaluate-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 138</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cached_evaluate</span>(<span class="ruby-identifier">scope</span>, <span class="ruby-identifier">locals</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">method</span> = <span class="ruby-identifier">compiled_method</span>(<span class="ruby-identifier">locals</span>.<span class="ruby-identifier">keys</span>)
  <span class="ruby-identifier">method</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-identifier">scope</span>).<span class="ruby-identifier">call</span>(<span class="ruby-identifier">locals</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- cached_evaluate-source -->
          
        </div>

        

        
      </div><!-- cached_evaluate-method -->

    
    </section><!-- protected-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-basename" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">basename</span><span
            class="method-args">(suffix='')</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The basename of the template file.</p>
          

          
          <div class="method-source-code" id="basename-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 80</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">basename</span>(<span class="ruby-identifier">suffix</span>=<span class="ruby-string">''</span>)
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">file</span>, <span class="ruby-identifier">suffix</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">file</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- basename-source -->
          
        </div>

        

        
      </div><!-- basename-method -->

    
      <div id="method-i-eval_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">eval_file</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The filename used in backtraces to describe the template.</p>
          

          
          <div class="method-source-code" id="eval_file-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 90</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">eval_file</span>
  <span class="ruby-identifier">file</span> <span class="ruby-operator">||</span> <span class="ruby-string">'(__TEMPLATE__)'</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- eval_file-source -->
          
        </div>

        

        
      </div><!-- eval_file-method -->

    
      <div id="method-i-name" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">name</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The template fileâ€™s basename with all extensions chomped off.</p>
          

          
          <div class="method-source-code" id="name-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 85</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">name</span>
  <span class="ruby-identifier">basename</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">'.'</span>, <span class="ruby-value">2</span>).<span class="ruby-identifier">first</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">basename</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- name-source -->
          
        </div>

        

        
      </div><!-- name-method -->

    
      <div id="method-i-render" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">render</span><span
            class="method-args">(scope=Object.new, locals={}, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Render the template in the given scope with the locals specified. If a
block is given, it is typically available within the template via
<code>yield</code>.</p>
          

          
          <div class="method-source-code" id="render-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 75</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">render</span>(<span class="ruby-identifier">scope</span>=<span class="ruby-constant">Object</span>.<span class="ruby-identifier">new</span>, <span class="ruby-identifier">locals</span>={}, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">evaluate</span> <span class="ruby-identifier">scope</span>, <span class="ruby-identifier">locals</span> <span class="ruby-operator">||</span> {}, &amp;<span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- render-source -->
          
        </div>

        

        
      </div><!-- render-method -->

    
    </section><!-- public-instance-method-details -->
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Protected Instance Methods</h3>

    
      <div id="method-i-cached_evaluate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cached_evaluate</span><span
            class="method-args">(scope, locals, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Process the template and return the result. The first time this method is
called, the template source is evaluated with instance_eval. On the
sequential method calls it will compile the template to an unbound method
which will lead to better performance. In any case, template executation is
guaranteed to be performed in the scope object with the locals specified
and with support for yielding to the block.</p>
          

          
          <div class="method-source-code" id="cached_evaluate-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 136</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cached_evaluate</span>(<span class="ruby-identifier">scope</span>, <span class="ruby-identifier">locals</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-comment"># Redefine itself to use method compilation the next time:</span>
  <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">cached_evaluate</span>(<span class="ruby-identifier">scope</span>, <span class="ruby-identifier">locals</span>, &amp;<span class="ruby-identifier">block</span>)
    <span class="ruby-identifier">method</span> = <span class="ruby-identifier">compiled_method</span>(<span class="ruby-identifier">locals</span>.<span class="ruby-identifier">keys</span>)
    <span class="ruby-identifier">method</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-identifier">scope</span>).<span class="ruby-identifier">call</span>(<span class="ruby-identifier">locals</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Use instance_eval the first time:</span>
  <span class="ruby-identifier">evaluate_source</span>(<span class="ruby-identifier">scope</span>, <span class="ruby-identifier">locals</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- cached_evaluate-source -->
          
        </div>

        

        
      </div><!-- cached_evaluate-method -->

    
      <div id="method-i-compiled_method" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">compiled_method</span><span
            class="method-args">(locals_keys)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>The compiled method for the locals keys provided.</p>
          

          
          <div class="method-source-code" id="compiled_method-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 200</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">compiled_method</span>(<span class="ruby-identifier">locals_keys</span>)
  <span class="ruby-ivar">@compiled_method</span>[<span class="ruby-identifier">locals_keys</span>] <span class="ruby-operator">||=</span>
    <span class="ruby-identifier">compile_template_method</span>(<span class="ruby-identifier">locals_keys</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- compiled_method-source -->
          
        </div>

        

        
      </div><!-- compiled_method-method -->

    
      <div id="method-i-evaluate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">evaluate</span><span
            class="method-args">(scope, locals, &block)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="evaluate-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 126</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">evaluate</span>(<span class="ruby-identifier">scope</span>, <span class="ruby-identifier">locals</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">cached_evaluate</span>(<span class="ruby-identifier">scope</span>, <span class="ruby-identifier">locals</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- evaluate-source -->
          
        </div>

        

        
      </div><!-- evaluate-method -->

    
      <div id="method-i-initialize_engine" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">initialize_engine</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Called once and only once for each template subclass the first time the
template class is initialized. This should be used to require the
underlying template library and perform any initial setup.</p>
          

          
          <div class="method-source-code" id="initialize_engine-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize_engine</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- initialize_engine-source -->
          
        </div>

        

        
      </div><!-- initialize_engine-method -->

    
      <div id="method-i-precompiled" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">precompiled</span><span
            class="method-args">(locals)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Generates all template source by combining the preamble, template, and
postamble and returns a two-tuple of the form: [source, offset], where
source is the string containing (Ruby) source code for the template and
offset is the integer line offset where line reporting should begin.</p>

<p><a href="Template.html">Template</a> subclasses may override this method
when they need complete control over source generation or want to adjust
the default line offset. In most cases, overriding the <a
href="Template.html#method-i-precompiled_template">precompiled_template</a>
method is easier and more appropriate.</p>
          

          
          <div class="method-source-code" id="precompiled-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 156</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">precompiled</span>(<span class="ruby-identifier">locals</span>)
  <span class="ruby-identifier">preamble</span> = <span class="ruby-identifier">precompiled_preamble</span>(<span class="ruby-identifier">locals</span>)
  <span class="ruby-identifier">template</span> = <span class="ruby-identifier">precompiled_template</span>(<span class="ruby-identifier">locals</span>)
  <span class="ruby-identifier">magic_comment</span> = <span class="ruby-identifier">extract_magic_comment</span>(<span class="ruby-identifier">template</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">magic_comment</span>
    <span class="ruby-comment"># Magic comment e.g. &quot;# coding: utf-8&quot; has to be in the first line.</span>
    <span class="ruby-comment"># So we copy the magic comment to the first line.</span>
    <span class="ruby-identifier">preamble</span> = <span class="ruby-identifier">magic_comment</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">preamble</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">parts</span> = [
    <span class="ruby-identifier">preamble</span>,
    <span class="ruby-identifier">template</span>,
    <span class="ruby-identifier">precompiled_postamble</span>(<span class="ruby-identifier">locals</span>)
  ]
  [<span class="ruby-identifier">parts</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>), <span class="ruby-identifier">preamble</span>.<span class="ruby-identifier">count</span>(<span class="ruby-string">&quot;\n&quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>]
<span class="ruby-keyword">end</span></pre>
          </div><!-- precompiled-source -->
          
        </div>

        

        
      </div><!-- precompiled-method -->

    
      <div id="method-i-precompiled_postamble" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">precompiled_postamble</span><span
            class="method-args">(locals)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Generates postamble code for the precompiled template source. The string
returned from this method is appended to the precompiled template source.</p>
          

          
          <div class="method-source-code" id="precompiled_postamble-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 195</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">precompiled_postamble</span>(<span class="ruby-identifier">locals</span>)
  <span class="ruby-string">''</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- precompiled_postamble-source -->
          
        </div>

        

        
      </div><!-- precompiled_postamble-method -->

    
      <div id="method-i-precompiled_preamble" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">precompiled_preamble</span><span
            class="method-args">(locals)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Generates preamble code for initializing template state, and performing
locals assignment. The default implementation performs locals assignment
only. Lines included in the preamble are subtracted from the source line
offset, so adding code to the preamble does not effect line reporting in
Kernel::caller and backtraces.</p>
          

          
          <div class="method-source-code" id="precompiled_preamble-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 188</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">precompiled_preamble</span>(<span class="ruby-identifier">locals</span>)
  <span class="ruby-identifier">locals</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{k} = locals[#{k.inspect}]&quot;</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- precompiled_preamble-source -->
          
        </div>

        

        
      </div><!-- precompiled_preamble-method -->

    
      <div id="method-i-precompiled_template" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">precompiled_template</span><span
            class="method-args">(locals)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>A string containing the (Ruby) source code for the template. The default <a
href="Template.html#method-i-evaluate">#evaluate</a> implementation
requires either this method or the <a
href="Template.html#method-i-precompiled">precompiled</a> method be
overridden. When defined, the base <a href="Template.html">Template</a>
guarantees correct file/line handling, locals support, custom scopes, and
support for template compilation when the scope object allows it.</p>
          

          
          <div class="method-source-code" id="precompiled_template-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 179</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">precompiled_template</span>(<span class="ruby-identifier">locals</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- precompiled_template-source -->
          
        </div>

        

        
      </div><!-- precompiled_template-method -->

    
      <div id="method-i-prepare" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">prepare</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Do whatever preparation is necessary to setup the underlying template
engine. Called immediately after template data is loaded. Instance
variables set in this method are available when <a
href="Template.html#method-i-evaluate">evaluate</a> is called.</p>

<p>Subclasses must provide an implementation of this method.</p>
          

          
          <div class="method-source-code" id="prepare-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 116</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">prepare</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:compile!</span>)
    <span class="ruby-comment"># backward compat with tilt &lt; 0.6; just in case</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-string">'Tilt::Template#compile! is deprecated; implement #prepare instead.'</span>
    <span class="ruby-identifier">compile!</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- prepare-source -->
          
        </div>

        

        
      </div><!-- prepare-method -->

    
      <div id="method-i-require_template_library" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">require_template_library</span><span
            class="method-args">(name)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Like Kernel::require but issues a warning urging a manual require when
running under a threaded environment.</p>
          

          
          <div class="method-source-code" id="require_template_library-source">
            <pre><span class="ruby-comment"># File lib/tilt/template.rb, line 103</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">require_template_library</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Thread</span>.<span class="ruby-identifier">list</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;WARN: tilt autoloading '#{name}' in a non thread-safe way; &quot;</span> <span class="ruby-operator">+</span>
         <span class="ruby-node">&quot;explicit require '#{name}' suggested.&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">require</span> <span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- require_template_library-source -->
          
        </div>

        

        
      </div><!-- require_template_library-method -->

    
    </section><!-- protected-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

